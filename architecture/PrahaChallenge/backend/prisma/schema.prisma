generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

// Teams table
model Team {
  id                String                 @id
  name              String
  pairs             Pair[]
  PairTeamBelonging PairTeamBelonging[]
}

// Pairs table
model Pair {
  id                     String                      @id
  name                   String
  teams                  Team[]
  members                Attendee[]
  AttendeePairMembership AttendeePairMembership[]
  PairTeamBelonging      PairTeamBelonging[]
}

// Attendees table
model Attendee {
  id          String                        @id
  name        String
  email       String
  status      AttendeeStatus             @relation(fields: [statusId], references: [id])
  statusId    String
  pairs       AttendeePairMembership[]
  assignments AttendeeAssignmentStatus[]
  Pair        Pair?                      @relation(fields: [pairId], references: [id])
  pairId      String?
}

// AttendeePairMemberships table
model AttendeePairMembership {
  attendee   Attendee @relation(fields: [attendeeId], references: [id])
  attendeeId String
  pair       Pair     @relation(fields: [pairId], references: [id])
  pairId     String

  @@id([attendeeId, pairId])
}

// PairTeamBelongings table
model PairTeamBelonging {
  team   Team @relation(fields: [teamId], references: [id])
  teamId String
  pair   Pair @relation(fields: [pairId], references: [id])
  pairId String

  @@id([teamId, pairId])
}

// Assignments table
model Assignment {
  id          String                        @id
  title       String
  description String
  attendees   AttendeeAssignmentStatus[]
}

// AttendeeStatuses table
model AttendeeStatus {
  id        String        @id
  name      String
  attendees Attendee[]
}

// AssignmentStatuses table
model AssignmentStatus {
  id        String                        @id
  name      String
  attendees AttendeeAssignmentStatus[]
}

// AttendeeAssignmentStatuses table
model AttendeeAssignmentStatus {
  attendee     Attendee         @relation(fields: [attendeeId], references: [id])
  attendeeId   String
  assignment   Assignment       @relation(fields: [assignmentId], references: [id])
  assignmentId String
  status       AssignmentStatus @relation(fields: [statusId], references: [id])
  statusId     String

  @@id([attendeeId, assignmentId])
}
