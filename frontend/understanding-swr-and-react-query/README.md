# SWR/React Queryを理解する

## 課題1

> React Queryの誕生の背景

サーバーサイドから取得するデータの状態管理の課題を解決するため。

- キャッシュ
- 同一リクエストの多重送信
- バックグラウンドでの古いデータの更新
- データが古くなったことの検知

etc

React Queryを使うことでこれらの管理が容易になる。


> 必要なデータを一箇所で取得してからpropsで渡したほうが良いのでは？

必要なデータを取得するコンポーネントがコンポーネントツリー内の遠くにある場合、propsのバケツリレーによって複数のコンポーネントを経由して渡さないといけない。
また、Optimistic Updateなどが必要なケースでは、データだけでなくデータ更新用の関数も必要になり、バケツリレーの対象が多くなる。

> 「SWRとかReact Queryを使うと、描画のタイミングでデータ取得が始まってしまうからコンポーネント単位でテストしづらくなりませんか？」

Mock Service Workerなどを用いて、ネットワークレベルでモックしてあげれば、テストは大変だとは思わない。

> SWRを使ってデータの取得と描画に関する責務を一つのコンポーネントにまとめてしまうのはSRP（単一責任原則）に違反している気がします

コンポーネントの役割を明確にしたい
Reactコンポーネントの場合、その責務は「特定のUIを表示すること」と捉えることができる。
このUIを表示するために必要なデータの取得も、コンポーネントの責務の一部として考えることができる。

SRPは、コンポーネントの責務が過度に複雑になるのを防ぐためのものである。
SWRを使ってデータ取得とUI描画を一つのコンポーネントにまとめても、そのコンポーネントがシンプルで理解しやすいものであれば、それはそれで良いのではないかと思う。

