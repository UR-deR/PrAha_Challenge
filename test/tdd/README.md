# TDD（テスト駆動開発）でコードを書いてみる

## 課題 1

### メリット

- こまめにテストを実行するのでバグを早期に発見できる
- テストコードが側にあるので、リファクタリングしやすい
- 関数やクラスのメソッドのインターフェースが明確になる
- 最初にテストを書くのでテストコードの実装漏れが発生し得ない（実装してからテストコード書くパターンだと起こりうる）

### デメリット

- テストコードの実装や保守の工数が必要になる（テストドリブンであることとは直接的な関係は無い）
- TDD 初心者だと開発スタイルへの順応に時間かかるかも
- テスト対象のクラスやメソッドが実装されていないので、AAA における Act の部分が空欄になるのではないかと思う（実装してからテストコード書くパターンだと、Act の部分は IDE が警告を発することなく書ける）
- 実装を先に書くパターンと比較した場合、どのようなモックが必要なのかがイメージしづらい

### 三角測量

より一般的な条件を満たすコードを実装するためにテストケースを増やす技法。
あるテストがたまたま通過したということが起こらないように、状況によって、複数の値を用いてテストを書く。

### レッドグリーンリファクタリング

TDD の基本開発スタイル。

**レッド**

実装のコードが何も書かれていなくて、テストコードが先行して書かれている状態。
無論、実装のコードが何も書かれていないので、テストは必ず失敗する。

**グリーン**

機能の実装を行うステップ。テストが PASS する（グリーンになる）ことを最優先に実装を行う。
コードの正しさや美しさは二の次

**リファクタリング**

グリーンな状態を保ちつつ、リファクタリングを行うフェーズ

### TDD と BDD の違い

<!-- BDD は TDD を拡張した手法であり、システムの予想される動作を確認するためのテストに重点を置いている。 -->

**何をテストするか**
TDD: より小さな機能の断片を分離してテストすることに重点を置いている。特定の機能の結果をアサーションする。
BDD: より高いレベルのシナリオやユースケースの結果のみに関心を持つ。

**どのようにテストコードを書くか**
TDD: 基本的には開発者だけで考える
BDD: PM, 開発者, QA が協力しあって考える

**メモ：BDD**

BDD を使用することにより開発者はどんなシステムを構築するかを正確に理解し、ビジネス要件を満たすソフトウェアを開発、提供することができるようになる。
BDD Practice を実行・実現しながら、 Outside-in の観点・関係を解決して , Gherkin language で記述していると BDD と呼べる。

※ BDD Practice
BDD のプラクティスは以下のようなことが実現出来ていることが望ましい

- ステークホルダーの要求を実装するためにゴールを明確にする
- フィーチャーを用いて必要な実装機能引き出す・相互理解を進める
- 開発の外部性を利用してステークスホルダーをプロセスに参加させる
- アプリケーションまたは単体機能で例を示す
- テストから迅速なフィードバックや回帰テストを自動化する
- 振舞から責務を明確にすることが出来て、機能単位の正確性を考察・理解する
- 振舞の結果判定から、スコープ範囲の問題かそれ以外の副作用かを判断する
- モックを利用してコラボレーション可能にする

※ Outside-in
BDD はビジネスバリュードリブンなので、ソフトウェア開発やコードが何と利害関係があるかや、それぞれのモジュールや機能の関係性を理解高める側面があります。
これによりステークホルダーとの利害関係や価値についての外部からの視点で解決が出来て、コードについて洞察が深まり、YAGNI な効果の側面もあります。

※Gherkin language
Gherkin という DSL を利用することで、開発者と QA エンジニア間で要件が明確になります。
合わせて、DSL でテスト内容を明確に記述できます

## 課題 2

[実装](https://github.com/axtx4869/praha-challenge-templates/blob/master/jestSample/caluculate.ts)
[テスト](https://github.com/axtx4869/praha-challenge-templates/blob/master/jestSample/__tests__/caluculate.test.ts)
