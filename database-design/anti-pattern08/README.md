## 解答

## 課題 1

主キーが具備すべき性質として以下のものがあると考える。

1. 一意性
1. NOT NULL である
1. 不変性

このうち１は企業担当者の発言から満たしていると考えられる。  
しかし２と３については確証が得られない。

### productCode は NOT NULL?

ケースとして存在するか不明ですが、「商品としては存在するが、productCode がまだ割り当てられていない」となった場合に productCode の値は NULL になると思いました。

### productCode は未来永劫不変？

ビジネスサイドの都合により、productCode が未来永劫不変な値であるという保証は無いように思いました。productCode に変更があった場合に、

- 外部キーとして product テーブルの productCode を参照しているテーブルに対しても更新が必要
- 他のレコードの productCode と重複が発生していないかの注意が必要

という点で、productCode を変更することに対してのコストは大きいと推測されます。そういった意味で、ビジネス側の要求に素早く柔軟な対応が可能かどうかという点で、良くない設計のように思います。

## 課題 2

以下のように、サロゲートキーを採用することによって課題１で挙げた問題は解消されると考えられる。  
特にビジネスドメインや外部環境から独立した値であることが強みであると思う。

![students (2)](https://user-images.githubusercontent.com/76472239/198808856-19679311-9b73-48fb-ab57-42bedfbb51c1.png)

## 課題 3

実体験として、とある医療系国家資格取得のための学習システムの開発をしている時に今回のアンチパターンに遭遇しました。  
各問題は question_code という一位な値を pk として持っているのですが、この question_code は問題カテゴリ、問題難易度、年度など複数の可変的な値を組み合わせた人工的な値であったため、不変性が担保しきれていない状態でした。

## 参考記事

[主キー駆動設計](https://qiita.com/wanko5296/items/a96bdeccc250f7c18cee)
